---
title: "Webアプリ 個人開発 初心者が、技術選定 考えました"
emoji: "↔️"
type: "tech"
topics: []
published: false
---

# はじめに
趣味や技術調査、ポートフォリオを兼ねて、幾つかのWebアプリケーションを個人開発+運用しています。

- [To-Dog List](https://zenn.dev/daiius/articles/14e62bd0770de3):
  Todo記録をかわいい犬が食べてしまうジョークアプリ
- [Sekirei Todo](https://zenn.dev/daiius/articles/b624d872db55d4):
  Todo記録をかわいい鳥が食べないアプリ
- [Girl's Side Analysis](https://zenn.dev/daiius/articles/08c65823dae37d):
  某恋愛シミュレーションゲームの推し組み合わせ分析アプリ
- [Videmus](https://zenn.dev/daiius/articles/441f35223269a6):
  OBSからブラウザへの低遅延動画配信システム
- [Cephylas](https://zenn.dev/daiius/articles/8f38ae1893c166):
  Dockerコンテナのリソース使用率記録+グラフ化アプリ
- Lantana Datagarden（開発中）:
  汎用的な科学技術データの記録・検索用アプリ

開発時、特に**Webアプリケーションに慣れていない頃は、
作りたいものが決まったとしても、それをどんな技術を使って作ればよいのか全く分からない**です。

**Next.js というものを使うのが良いのか、より軽量なSPA中心のフレームワークを選ぶか、Next.jsはバックエンド機能も兼ねるが別にサーバを開発する必要が有るか、データベースは必要なのか**、といった疑問を持ちつつ、開発前にかなりの時間を技術調査に充てていました。

5-6個、大幅なやり直しもしつつWebアプリケーションを作った現在の著者の感覚で、**上記の疑問に対する答えを一旦整理するのがこの記事の目的です。**



# データベースは必要か？
これは割と簡単に決められる節が有ります。
**「アプリケーションやサーバが再起動しても、サーバ側に記録し続けたいデータが有る」ならばデータベースを使う**のが良いでしょう。
:::details さすがにもう少し詳しく......
素朴な考え方ですが、プログラム中で変数に記録された情報は基本的にメモリ内にあります。

メモリ内の情報は、PCが再起動したときには失われます。

プログラムをいったん終了して再度起動したときにも失われます。

「それでは困る！」というデータはデータベースに記録するのが良いでしょう。

**例：
登録ユーザのリスト、人気投票の結果、その他ユーザが記録したいデータ**

メインメモリでなくファイルシステムにデータを記録出来れば、再起動でデータが失われないかも？ですので、文字通り「データベース」である必要は無いかもしれません。

逆にデータベースに入れなくても良さそうなのは、再起動時に失われてもよさそうなものです。

**例：
勝敗が有耶無耶になってもよいカジュアルに繰り返せるゲームの進行状況、
簡単に再実行できる計算の結果**

「データベース」と呼ばれるものには様々な種類が有りますが、MySQLやPostgresSQLといったRDBは比較的硬派な（私の好きな）選択肢です。

最近はこれらのデータベース環境を用意してくれるサービスも色々あります。
[Vercel Postgres](https://vercel.com/docs/storage/vercel-postgres), [PlanetScale](https://planetscale.com/), [Supabase](https://supabase.com/)

:::

各ユーザ側（ブラウザ側）にデータを記録すれば済む場合、制限が多くなりますが、cookie, jwt, localStorage 等の選択肢もありそうです。

# Next.jsで開発時、バックエンドサーバ開発は必要か？
Next.jsはバックエンド処理も含めて扱えますので、バックエンドサーバの開発は不要となる場合と、実はそうでない場合も有ります。

**「ユーザが何かの操作を目的にHTTPリクエストをサーバに送信した際、そのタイミングでサーバ側で処理をすることで完結する」ならば Next.js (+DB) で完結します。**
言い換えると、
**「ユーザの操作と関係ないタイミングで処理を行う必要がある」ならば Next.js (+ DB) と別のバックエンドサーバが必要です。**

:::details もう少し詳しく...
Next.jsはキャッシュ戦略を始めとして効率的な動作を追及しています。
ユーザがサーバの存在を意識しなくてよい「サーバーレス」な動作も同様です。

そこではNext.jsアプリケーションが柔軟な数で並列で起動していたり、使わない間は終了されていたりするかもしれません。

これを実現するにはNext.jsアプリケーション自体が状態を持たないようにする必要があります（複数起動したアプリケーションの内部状態が食い違ったら困ります）。

そのため**Next.jsアプリケーションは、例えバックエンド側であっても、リクエストを跨ぐ状態を変数に記録することは出来ない様です。**

この制限はかなり大きいもので、**結果としてNext.js単体ではユーザのリクエストと関係のないタイミングで何かの処理を行うことが出来ません。**

**Next.js（+DB）で実現できる例：**
- ユーザがアクセス時、DBからTodoリストを表示し、編集時にDBを更新する
- ユーザがアクセス時、DBから投票結果を表示し、投票時にDBを更新する

**Next.js（+DB）の他にバックエンドサーバが必要な例：**
- 10秒間隔でDockerコンテナのリソース使用率のログをとる
- OBSからWebRTCストリーム配信を受信し続け、視聴者に送信し続ける

:::
Next.jsとバックエンドサーバはHTTP通信するのが一般的ですから、REST APIサーバを作成する要領で開発します。
[express](https://expressjs.com/) + [tRPC](https://trpc.io/) ですとか、[Hono](https://hono.dev/) とかお勧めできそうです。

# そもそも Next.js を使うべきか？
Next.jsは様々な最適化手法をもつ大変便利なフレームワークなのですが、下記の様なものを作りたい場合には、より軽量なフレームワークが良いかもしれません。
- **1ページで完結する大変シンプルなアプリ**
  Next.jsではオーバーキル気味です。
  技術調査を兼ねるのであれば、選択肢としてはアリだと思います。
- **他ユーザの変更を短時間で画面に反映する等、リアルタイム動作するアプリ**
  リアルタイム要素はNext.jsとは重なっておらず、
  両方を考慮してコード量が増えるならばリアルタイム要素に集中し、フロントエンド要素は軽量なSPA向けフレームワーク等使用するのが良いかもしれません。